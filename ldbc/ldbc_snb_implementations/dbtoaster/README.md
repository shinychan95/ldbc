# DBToaster experimental implementation

This folder holds some experimental, preliminary query implementations
for the [DBToaster] SQL interface


## Preparation

 1. place CSV files of **merge foreign key flavour** generated by the datagen in the `data/raw` directory
 2. prepare CSV files for DBToaster by running `prepare-data.sh` from the LDBC SNB DBToaster implementation directory

Note: `prepare-data.sh` accepts directory names as parameters to read and write to other directories:

 1. the input directory, where the datagen's CSV files reside. Defaults to `./data/raw`
 2. the output data directory, where output files are placed. Defaults to `./data`

## Running BI queries

The `bi-query-util.sh` is provided for convenience to run a single BI query through DBToaster after loading the schema and data.

This by default assumes that DBToaster binary if located at `$HOME/bin/dbtoaster/bin/dbtoaster`.
To override DBToaster path, set the `DBTOASTER_BIN` environment variable pointing to the DBToaster binary.

Example:

```shell
user@machine:~/git/ldbc_snb_implementations/dbtoaster$ ./bi-query-util.sh 1
```

## Generate Scala JAR

Again, the `bi-query-util.sh` can be used to generate Scala JAR for the given BI query.

Simply provide the generator script with `jar` in the 2nd parameter to generate `ldbc-bi-q$n.jar` under the `target/` directory, where `$n` is the number of the BI query.

Example:

```shell
user@machine:~/git/ldbc_snb_implementations/dbtoaster$ ./bi-query-util.sh 1 jar
```

A few things to know about the generated query class:

 - the query name is `biQ$n`, again, `$n` stands for the query number
 - the query looks for the input CSV files in the `data/` subdirectory of the current working dir

[DBToaster]: https://dbtoaster.github.io/
